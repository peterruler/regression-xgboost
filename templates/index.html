{% extends "base.html" %}

{% block content %}
  {% if model_error %}
    <div class="flash error">{{ model_error }}</div>
  {% endif %}

  {% if sample_options %}
    <form class="sample-bar" method="get">
      <div class="field">
        <label for="sample">Sample car</label>
        <select id="sample" name="sample">
          {% for option in sample_options %}
            <option value="{{ option.id }}" {% if option.id == current_sample_id %}selected{% endif %}>
              {{ option.label }}
            </option>
          {% endfor %}
        </select>
      </div>
      <button type="submit">Fill sample</button>
      {% if default_sample_id %}
        <a class="secondary" href="{{ url_for('index', sample=default_sample_id) }}">{{ default_sample_label }}</a>
      {% endif %}
    </form>
  {% endif %}

  <form method="post" novalidate>
    {{ form.hidden_tag() }}
    <div class="grid">
      {% for group in group_specs %}
        {% set field = form[group.field_name] %}
        <div class="field">
          {{ field.label }}
          {{ field() }}
          {% if field.errors %}
            <div class="errors">{{ field.errors|join(", ") }}</div>
          {% endif %}
        </div>
      {% endfor %}

      {% for col, _field_type in feature_specs %}
        {% set field = form[col] %}
        {% if field.type == "BooleanField" %}
          <div class="checkbox-field">
            {{ field() }} {{ field.label.text }}
          </div>
        {% else %}
          <div class="field">
            {{ field.label }}
            {{ field() }}
            {% if field.errors %}
              <div class="errors">{{ field.errors|join(", ") }}</div>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </div>
    <div class="actions">
      {{ form.submit() }}
      <a class="secondary" href="{{ url_for('reset') }}">Reset</a>
    </div>
  </form>

  {% if prediction is not none %}
    <div class="result">
      Predicted selling price: {{ "%.2f"|format(prediction) }}
    </div>
  {% endif %}
{% endblock %}
